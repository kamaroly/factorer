

<?php $__env->startSection('content_title'); ?>
  <?php echo e(trans('navigations.refunds_'.strtolower($refundLoanType))); ?>

<?php $__env->stopSection(); ?>
<?php $__env->startSection('content'); ?>
 <script language="JavaScript">
function toggle(source) {
 checkboxes = document.getElementsByName('memberIds[]');
  for(var i=0, n=checkboxes.length;i<n;i++) {
    checkboxes[i].checked = source.checked;
  }
}
</script>

<?php if(!is_null($transactionid) && $transactionid !=false): ?>
  <script type="text/javascript">
    OpenInNewTab("<?php echo route('piece.disbursed.refund',['transactionid'=>$transactionid]); ?>")
  </script>
<?php endif; ?>
  <?php echo $__env->make('refunds.upload_form',['route'=>'contributions.batch'], array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
  <?php echo Form::open(['route'=>'refunds.complete']); ?>

  <?php echo $__env->make('refunds.form',['institutionId'=>'institutionId'], array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
     <?php /* only show this if we have members ... */ ?>
  <?php if(count($members) > 0): ?>
  <?php echo Form::open(array('route'=>'refunds.complete','method'=>'POST')); ?>

  <label><?php echo e(trans('refund.libelle')); ?></label>
  <?php echo Form::text('wording', 
             (!empty($wording)) ? $wording : trans('refund.refund_for_the_month_of').' '.$month.date('/Y'),
              ['class'=>'form-control','placeholder'=>'refund for this month ....']); ?>

  <?php echo $__env->make('contributionsandsavings.buttons',['cancelRoute'=>'refunds.cancel'], array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
  <?php echo Form::close(); ?>




  <?php echo str_replace('href="/?page=', 'href="'.Request::url().'?'.$_SERVER['QUERY_STRING'].'&page=', $pageLinks->render()); ?>


  <table class="table table-bordered">
  	 <thead>
  	 	<tr>
        <th> <input type="checkbox" onClick="toggle(this)" checked/> </th>
        <th> <?php echo e(trans('member.adhersion_number')); ?></th>
        <th> <?php echo e(trans('member.member')); ?></th>
        <th> <?php echo e(trans('member.institution')); ?></th>
        <th> <?php echo e(trans('member.employee_id')); ?></th>
        <th> <?php echo e(trans('member.refund_fees')); ?></th>
  	 		<th><i class="fa fa-gear"></i></th>
  	 	</tr>
   	 </thead>
 <tbody>
   <?php echo $__env->renderEach('refunds.item', $members, 'member', 'refunds.no-items'); ?>
 </tbody>
</table>
  <?php endif; ?>
 <?php echo Form::close(); ?>

<?php $__env->stopSection(); ?>

<?php $__env->startSection('scripts'); ?>

<script type="text/javascript">
  jQuery(document).ready(function($) {
    $('#refund-loan-type').change(function(event) {
      /* Act on the event */    
      var refundType = $(this);
  
      window.location.href = window.location.protocol+'//'+window.location.host+window.location.pathname+'?refund-loan-type='+refundType.val();

    });
  });
</script>
<?php $__env->stopSection(); ?>
<?php echo $__env->make('layouts.default', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>