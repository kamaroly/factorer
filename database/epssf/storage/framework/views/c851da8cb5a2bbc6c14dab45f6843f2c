<?php echo $__env->make('partials.landscapecss', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>

<?php /* Start by pulling this member profile */ ?>
<?php if(!$contributions->isEmpty()): ?>
	<?php echo $__env->make('reports.member.partials.profile',['member'=>$contributions->last()->member], array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
<?php endif; ?> 
<table class="pure-table pure-table-bordered ">
<caption class="text-xl text-gray-700 font-semibold"> <?php echo e(trans('reports.member_contribution_file')); ?> <?php echo e(Request::segment(4).' Et '.Request::segment(5)); ?> </caption>
  	 <thead>
  	 	<tr>
	  	 	<th><?php echo e(trans('general.date')); ?></th>
	     	<th><?php echo e(trans('loan.nature')); ?></th>
			<th><?php echo e(trans('contributions.operation_type')); ?></th>
			<th><?php echo e(trans('loan.wording')); ?></th>
			<th><?php echo e(trans('loan.saving')); ?></th>
	        <th><?php echo e(trans('loan.withdrawal')); ?></th>
	        <th><?php echo e(trans('general.balance')); ?></th>
	  	</tr>
   	 </thead>
 <tbody class="text-sm">

<?php /* Get balance per transactions */ ?>
<?php $balance = 0; ?>
 <?php foreach($contributions as $contribution): ?>
   <?php $balance += (strtolower($contribution->transaction_type) == 'saving') ? $contribution->amount : -1*$contribution->amount; ?>

   <?php echo $__env->make('reports.member.item_contribution_record', compact('contribution','balance'), array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>   
 <?php endforeach; ?>
   <tr>
 	<th colspan="4"><?php echo e(trans('general.summary')); ?></th>

	<th class="text-green-600"><?php echo e(moneyFormat($total_savings)); ?></th>
	<th class="text-yellow-600"><?php echo e(moneyFormat($total_withdrawal)); ?></th>
	<th class="text-green-800"><?php echo e(moneyFormat($balance)); ?></th>
</tr>

 </tbody>
</table>

<table class="pure-table pure-table-bordered text-sm">
  	 	<tr>
  	 	<td>
	  	 		<strong><?php echo e(trans('report.beneficiaire')); ?></strong><br/>
				<?php echo $contributions->first()->member->names; ?>

	  	 	</td>
	  	 	<td>
	  	 		<strong><?php echo e(trans('report.done_by')); ?></strong><br/>
	  	 		<?php $user = Sentry::getUser(); ?>
				<?php echo $user->first_name; ?> <?php echo $user->last_name; ?>

	  	 	</td>
	     	<td><strong><?php echo e(trans('report.authorized')); ?></strong><br/>
				<?php echo (new Ceb\Models\Setting)->get('general.gerant'); ?>

			</td>
			
			<!--<td><strong><?php echo e(trans('report.tresorien')); ?></strong><br/>
				<?php echo (new Ceb\Models\Setting)->get('general.tresorien'); ?>

				</td> -->
			<td colspan="2"><strong><?php echo e(trans('report.audited')); ?></strong><br/>
				<?php echo (new Ceb\Models\Setting)->get('general.controller'); ?>

				</td>

				<td><strong><?php echo e(trans('report.approved_CA')); ?></strong><br/>
				<?php echo (new Ceb\Models\Setting)->get('general.president'); ?>

				
				</td>
			<!--<td><strong><?php echo e(trans('report.administrator')); ?></strong><br/>
				<?php echo (new Ceb\Models\Setting)->get('general.administrator'); ?>

				</td> -->
	  	</tr>
	  	<tr style="height: 50px;">
	  		<td><strong>Signature:</strong></td>
	  		<td><strong>Signature:</strong></td>
	  		<td><strong>Signature:</strong></td>
	  		<!--<td><strong>Signature:</strong></td>
	  		<td><strong>Signature:</strong></td>-->
	  		<td colspan="2"><strong>Signature:</strong></td>
	  		<td><strong>Signature:</strong></td>
	  	</tr>
 </table>
